---
title: "analysis"
output: html_document
---

```{r setup}

## Clear workspace
rm(list=ls())

## The "pacman" package automatically install missing packages and load them
if (!require("pacman")) install.packages("pacman", repos = 'https://stat.ethz.ch/CRAN/'); 

pacman::p_load(
  # data processing
  tidyverse,  # collection of the tidyverse packages
  stringr,    #   - for string functions
  forcats,    #   - utility functions for working with factor levels
  lubridate,  #   - utility for parsing and performing arithematic on dates 
  tools,      #   - for package development, administration and documentation
  data.table, #   - for data manipulation 
  tibble      #   - to create data frames
)
```

## Data Import

```{r import}

# Create a function that imports all .sd2 files from a directory

import_raw_data_file <- function(dir_name, condition_name) {
  
  file_list <- list.files(path = file.path("02 raw data", dir_name), pattern = "*.sd2", recursive = TRUE, full.names = TRUE)
  
  raw_data <- do.call("rbind", lapply(file_list, function(filename)
  data.frame(read.delim(filename, sep = ","))))
  
  # Overwrite Condition because it was used inconsistently during the experiments
  # Therefore, the correct condition needs to be given as a function parameter
  raw_data$Condition = condition_name
  
  return(raw_data)
  
}

# import all .sd2 files from all conditions and combine them into a single table

sd2_data_raw <- rbind(
  import_raw_data_file("1_trackpad", "trackpad"),
  import_raw_data_file("2_index finger", "index finger"),
  import_raw_data_file("3_thumb", "thumb"),
  import_raw_data_file("4_sway", "sway")
)

```

## Data Clean Up

```{r clean up}

sd2_data_raw <- sd2_data_raw %>% 
  select(
    Participant, 
    Condition, 
    'Target Amplitude' = A, 
    'Target Width' = W, 
    'Pointing Time (ms)' = PT.ms.,
    'Selection Time (ms)' = ST.ms.,
    'Movement Time (ms)' = MT.ms.,
    'Error Rate (%)' = ER...,
    'Throughput (bits/s)' = TP.bps.
  )

```
